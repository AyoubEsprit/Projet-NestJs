{
  "info": {
    "name": "NestJS Workshop - Ateliers 1 & 2",
    "description": "Collection complète pour tester les deux ateliers NestJS",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "ATELIER 1 - CRUD de base",
      "item": [
        {
          "name": "1. Créer un utilisateur",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"password123\",\n  \"role\": \"CLIENT\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/users",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["users"]
            }
          }
        },
        {
          "name": "2. Activer un utilisateur",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/users/activate",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["users", "activate"]
            }
          }
        },
        {
          "name": "3. Obtenir un utilisateur par ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/users/:id",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["users", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "YOUR_USER_ID"
                }
              ]
            }
          }
        },
        {
          "name": "4. Obtenir un utilisateur par email",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/users/email/user@example.com",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["users", "email", "user@example.com"]
            }
          }
        },
        {
          "name": "5. Obtenir tous les utilisateurs actifs",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/users/active/list",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["users", "active", "list"]
            }
          }
        },
        {
          "name": "6. Mettre à jour un utilisateur",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"newemail@example.com\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/users/:id",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["users", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "YOUR_USER_ID"
                }
              ]
            }
          }
        },
        {
          "name": "7. Supprimer un utilisateur",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/users/:id",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["users", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "YOUR_USER_ID"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ATELIER 2 - Admin (tous les champs)",
      "item": [
        {
          "name": "1. Liste complète des utilisateurs",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users"]
            }
          }
        },
        {
          "name": "2. Utilisateurs non mis à jour depuis 6 mois",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/not-updated?months=6",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "not-updated"],
              "query": [
                {
                  "key": "months",
                  "value": "6"
                }
              ]
            }
          }
        },
        {
          "name": "3. Utilisateurs par domaine email",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/by-domain/example.com",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "by-domain", "example.com"]
            }
          }
        },
        {
          "name": "4. Utilisateurs créés dans les 7 derniers jours",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/recent?days=7",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "recent"],
              "query": [
                {
                  "key": "days",
                  "value": "7"
                }
              ]
            }
          }
        },
        {
          "name": "5. Statistiques - Comptage par rôle",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/stats/by-role",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "stats", "by-role"]
            }
          }
        },
        {
          "name": "6. Utilisateurs entre deux dates",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/stats/between-dates?startDate=2024-01-01&endDate=2024-12-31",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "stats", "between-dates"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2024-01-01"
                },
                {
                  "key": "endDate",
                  "value": "2024-12-31"
                }
              ]
            }
          }
        },
        {
          "name": "7. Utilisateurs les plus récents",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/stats/most-recent?limit=10",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "stats", "most-recent"],
              "query": [
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "8. Moyenne des jours entre création et mise à jour",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/stats/average-days",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "stats", "average-days"]
            }
          }
        },
        {
          "name": "9. Pagination",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/paginated?page=1&limit=10",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "paginated"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "10. Tri par date de création",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/sorted/created?order=DESC",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "sorted", "created"],
              "query": [
                {
                  "key": "order",
                  "value": "DESC"
                }
              ]
            }
          }
        },
        {
          "name": "11. Tri multiple (rôle puis date)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/sorted/multiple",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "sorted", "multiple"]
            }
          }
        },
        {
          "name": "12. Désactiver les comptes inactifs",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/admin/users/deactivate-inactive?months=12",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "deactivate-inactive"],
              "query": [
                {
                  "key": "months",
                  "value": "12"
                }
              ]
            }
          }
        },
        {
          "name": "13. Mise à jour en masse du rôle par domaine",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "x-user-role",
                "value": "ADMIN"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"role\": \"ADMIN\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/admin/users/bulk-update-role?domain=example.com",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["admin", "users", "bulk-update-role"],
              "query": [
                {
                  "key": "domain",
                  "value": "example.com"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "ATELIER 2 - Client (champs limités)",
      "item": [
        {
          "name": "1. Liste des utilisateurs (id et email uniquement)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "CLIENT"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/client/users",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["client", "users"]
            }
          }
        },
        {
          "name": "2. Pagination (id et email uniquement)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-user-role",
                "value": "CLIENT"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/client/users/paginated?page=1&limit=10",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["client", "users", "paginated"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            }
          }
        }
      ]
    }
  ]
}

